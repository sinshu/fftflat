using System;
using System.Numerics;
using NUnit.Framework;

namespace FftFlatTest
{
    public class KissFftInternalConsistency
    {
        private static readonly Complex[] twiddles8 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.707106781187, -0.707106781187),
            new(0.000000000000, -1.000000000000),
            new(-0.707106781187, -0.707106781187),
            new(-1.000000000000, -0.000000000000),
            new(-0.707106781187, 0.707106781187),
            new(-0.000000000000, 1.000000000000),
            new(0.707106781187, 0.707106781187),
        };
        private static readonly int[] stageRadix8 = new int[] { 4, 2 };
        private static readonly int[] stageRemainder8 = new int[] { 2, 1 };

        private static readonly Complex[] twiddles9 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.766044443119, -0.642787609687),
            new(0.173648177667, -0.984807753012),
            new(-0.500000000000, -0.866025403784),
            new(-0.939692620786, -0.342020143326),
            new(-0.939692620786, 0.342020143326),
            new(-0.500000000000, 0.866025403784),
            new(0.173648177667, 0.984807753012),
            new(0.766044443119, 0.642787609687),
        };
        private static readonly int[] stageRadix9 = new int[] { 3, 3 };
        private static readonly int[] stageRemainder9 = new int[] { 3, 1 };

        private static readonly Complex[] twiddles10 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.809016994375, -0.587785252292),
            new(0.309016994375, -0.951056516295),
            new(-0.309016994375, -0.951056516295),
            new(-0.809016994375, -0.587785252292),
            new(-1.000000000000, -0.000000000000),
            new(-0.809016994375, 0.587785252292),
            new(-0.309016994375, 0.951056516295),
            new(0.309016994375, 0.951056516295),
            new(0.809016994375, 0.587785252292),
        };
        private static readonly int[] stageRadix10 = new int[] { 2, 5 };
        private static readonly int[] stageRemainder10 = new int[] { 5, 1 };

        private static readonly Complex[] twiddles11 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.841253532831, -0.540640817456),
            new(0.415415013002, -0.909631995355),
            new(-0.142314838273, -0.989821441881),
            new(-0.654860733945, -0.755749574354),
            new(-0.959492973614, -0.281732556841),
            new(-0.959492973614, 0.281732556841),
            new(-0.654860733945, 0.755749574354),
            new(-0.142314838273, 0.989821441881),
            new(0.415415013002, 0.909631995355),
            new(0.841253532831, 0.540640817456),
        };
        private static readonly int[] stageRadix11 = new int[] { 11 };
        private static readonly int[] stageRemainder11 = new int[] { 1 };

        private static readonly Complex[] twiddles12 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.866025403784, -0.500000000000),
            new(0.500000000000, -0.866025403784),
            new(0.000000000000, -1.000000000000),
            new(-0.500000000000, -0.866025403784),
            new(-0.866025403784, -0.500000000000),
            new(-1.000000000000, -0.000000000000),
            new(-0.866025403784, 0.500000000000),
            new(-0.500000000000, 0.866025403784),
            new(-0.000000000000, 1.000000000000),
            new(0.500000000000, 0.866025403784),
            new(0.866025403784, 0.500000000000),
        };
        private static readonly int[] stageRadix12 = new int[] { 4, 3 };
        private static readonly int[] stageRemainder12 = new int[] { 3, 1 };

        private static readonly Complex[] twiddles13 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.885456025653, -0.464723172044),
            new(0.568064746731, -0.822983865894),
            new(0.120536680255, -0.992708874098),
            new(-0.354604887043, -0.935016242685),
            new(-0.748510748171, -0.663122658241),
            new(-0.970941817426, -0.239315664288),
            new(-0.970941817426, 0.239315664288),
            new(-0.748510748171, 0.663122658241),
            new(-0.354604887043, 0.935016242685),
            new(0.120536680255, 0.992708874098),
            new(0.568064746731, 0.822983865894),
            new(0.885456025653, 0.464723172044),
        };
        private static readonly int[] stageRadix13 = new int[] { 13 };
        private static readonly int[] stageRemainder13 = new int[] { 1 };

        private static readonly Complex[] twiddles14 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.900968867902, -0.433883739118),
            new(0.623489801859, -0.781831482468),
            new(0.222520933956, -0.974927912182),
            new(-0.222520933956, -0.974927912182),
            new(-0.623489801859, -0.781831482468),
            new(-0.900968867902, -0.433883739118),
            new(-1.000000000000, -0.000000000000),
            new(-0.900968867902, 0.433883739118),
            new(-0.623489801859, 0.781831482468),
            new(-0.222520933956, 0.974927912182),
            new(0.222520933956, 0.974927912182),
            new(0.623489801859, 0.781831482468),
            new(0.900968867902, 0.433883739118),
        };
        private static readonly int[] stageRadix14 = new int[] { 2, 7 };
        private static readonly int[] stageRemainder14 = new int[] { 7, 1 };

        private static readonly Complex[] twiddles15 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.913545457643, -0.406736643076),
            new(0.669130606359, -0.743144825477),
            new(0.309016994375, -0.951056516295),
            new(-0.104528463268, -0.994521895368),
            new(-0.500000000000, -0.866025403784),
            new(-0.809016994375, -0.587785252292),
            new(-0.978147600734, -0.207911690818),
            new(-0.978147600734, 0.207911690818),
            new(-0.809016994375, 0.587785252292),
            new(-0.500000000000, 0.866025403784),
            new(-0.104528463268, 0.994521895368),
            new(0.309016994375, 0.951056516295),
            new(0.669130606359, 0.743144825477),
            new(0.913545457643, 0.406736643076),
        };
        private static readonly int[] stageRadix15 = new int[] { 3, 5 };
        private static readonly int[] stageRemainder15 = new int[] { 5, 1 };

        private static readonly Complex[] twiddles16 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.923879532511, -0.382683432365),
            new(0.707106781187, -0.707106781187),
            new(0.382683432365, -0.923879532511),
            new(0.000000000000, -1.000000000000),
            new(-0.382683432365, -0.923879532511),
            new(-0.707106781187, -0.707106781187),
            new(-0.923879532511, -0.382683432365),
            new(-1.000000000000, -0.000000000000),
            new(-0.923879532511, 0.382683432365),
            new(-0.707106781187, 0.707106781187),
            new(-0.382683432365, 0.923879532511),
            new(-0.000000000000, 1.000000000000),
            new(0.382683432365, 0.923879532511),
            new(0.707106781187, 0.707106781187),
            new(0.923879532511, 0.382683432365),
        };
        private static readonly int[] stageRadix16 = new int[] { 4, 4 };
        private static readonly int[] stageRemainder16 = new int[] { 4, 1 };

        private static readonly Complex[] twiddles32 = new Complex[]
        {
            new(-0.195090322016, -0.980785280403),
            new(-0.382683432365, -0.923879532511),
            new(-0.555570233020, -0.831469612303),
            new(-0.707106781187, -0.707106781187),
            new(-0.831469612303, -0.555570233020),
            new(-0.923879532511, -0.382683432365),
            new(-0.980785280403, -0.195090322016),
            new(-1.000000000000, -0.000000000000),
            new(-0.980785280403, 0.195090322016),
            new(-0.923879532511, 0.382683432365),
            new(-0.831469612303, 0.555570233020),
            new(-0.707106781187, 0.707106781187),
            new(-0.555570233020, 0.831469612303),
            new(-0.382683432365, 0.923879532511),
            new(-0.195090322016, 0.980785280403),
            new(-0.000000000000, 1.000000000000),
            new(0.195090322016, 0.980785280403),
            new(0.382683432365, 0.923879532511),
            new(0.555570233020, 0.831469612303),
            new(0.707106781187, 0.707106781187),
            new(0.831469612303, 0.555570233020),
            new(0.923879532511, 0.382683432365),
            new(0.980785280403, 0.195090322016),
        };
        private static readonly int[] stageRadix32 = new int[] { 4, 4, 2 };
        private static readonly int[] stageRemainder32 = new int[] { 8, 2, 1 };

        private static readonly Complex[] twiddles50 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.992114701314, -0.125333233564),
            new(0.968583161129, -0.248689887165),
            new(0.929776485888, -0.368124552685),
            new(0.876306680044, -0.481753674102),
            new(0.809016994375, -0.587785252292),
            new(0.728968627421, -0.684547105929),
            new(0.637423989749, -0.770513242776),
            new(0.535826794979, -0.844327925502),
            new(0.425779291565, -0.904827052466),
            new(0.309016994375, -0.951056516295),
            new(0.187381314586, -0.982287250729),
            new(0.062790519529, -0.998026728428),
            new(-0.062790519529, -0.998026728428),
            new(-0.187381314586, -0.982287250729),
            new(-0.309016994375, -0.951056516295),
            new(-0.425779291565, -0.904827052466),
            new(-0.535826794979, -0.844327925502),
            new(-0.637423989749, -0.770513242776),
            new(-0.728968627421, -0.684547105929),
            new(-0.809016994375, -0.587785252292),
            new(-0.876306680044, -0.481753674102),
            new(-0.929776485888, -0.368124552685),
            new(-0.968583161129, -0.248689887165),
            new(-0.992114701314, -0.125333233564),
            new(-1.000000000000, 0.000000000000),
            new(-0.992114701314, 0.125333233564),
            new(-0.968583161129, 0.248689887165),
            new(-0.929776485888, 0.368124552685),
            new(-0.876306680044, 0.481753674102),
            new(-0.809016994375, 0.587785252292),
            new(-0.728968627421, 0.684547105929),
            new(-0.637423989749, 0.770513242776),
            new(-0.535826794979, 0.844327925502),
            new(-0.425779291565, 0.904827052466),
            new(-0.309016994375, 0.951056516295),
            new(-0.187381314586, 0.982287250729),
            new(-0.062790519529, 0.998026728428),
            new(0.062790519529, 0.998026728428),
            new(0.187381314586, 0.982287250729),
            new(0.309016994375, 0.951056516295),
            new(0.425779291565, 0.904827052466),
            new(0.535826794979, 0.844327925502),
            new(0.637423989749, 0.770513242776),
            new(0.728968627421, 0.684547105929),
            new(0.809016994375, 0.587785252292),
            new(0.876306680044, 0.481753674102),
            new(0.929776485888, 0.368124552685),
            new(0.968583161129, 0.248689887165),
            new(0.992114701314, 0.125333233564),
        };
        private static readonly int[] stageRadix50 = new int[] { 2, 5, 5 };
        private static readonly int[] stageRemainder50 = new int[] { 25, 5, 1 };

        private static readonly Complex[] twiddles64 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.995184726672, -0.098017140330),
            new(0.980785280403, -0.195090322016),
            new(0.956940335732, -0.290284677254),
            new(0.923879532511, -0.382683432365),
            new(0.881921264348, -0.471396736826),
            new(0.831469612303, -0.555570233020),
            new(0.773010453363, -0.634393284164),
            new(0.707106781187, -0.707106781187),
            new(0.634393284164, -0.773010453363),
            new(0.555570233020, -0.831469612303),
            new(0.471396736826, -0.881921264348),
            new(0.382683432365, -0.923879532511),
            new(0.290284677254, -0.956940335732),
            new(0.195090322016, -0.980785280403),
            new(0.098017140330, -0.995184726672),
            new(0.000000000000, -1.000000000000),
            new(-0.098017140330, -0.995184726672),
            new(-0.195090322016, -0.980785280403),
            new(-0.290284677254, -0.956940335732),
            new(-0.382683432365, -0.923879532511),
            new(-0.471396736826, -0.881921264348),
            new(-0.555570233020, -0.831469612303),
            new(-0.634393284164, -0.773010453363),
            new(-0.707106781187, -0.707106781187),
            new(-0.773010453363, -0.634393284164),
            new(-0.831469612303, -0.555570233020),
            new(-0.881921264348, -0.471396736826),
            new(-0.923879532511, -0.382683432365),
            new(-0.956940335732, -0.290284677254),
            new(-0.980785280403, -0.195090322016),
            new(-0.995184726672, -0.098017140330),
            new(-1.000000000000, -0.000000000000),
            new(-0.995184726672, 0.098017140330),
            new(-0.980785280403, 0.195090322016),
            new(-0.956940335732, 0.290284677254),
            new(-0.923879532511, 0.382683432365),
            new(-0.881921264348, 0.471396736826),
            new(-0.831469612303, 0.555570233020),
            new(-0.773010453363, 0.634393284164),
            new(-0.707106781187, 0.707106781187),
            new(-0.634393284164, 0.773010453363),
            new(-0.555570233020, 0.831469612303),
            new(-0.471396736826, 0.881921264348),
            new(-0.382683432365, 0.923879532511),
            new(-0.290284677254, 0.956940335732),
            new(-0.195090322016, 0.980785280403),
            new(-0.098017140330, 0.995184726672),
            new(-0.000000000000, 1.000000000000),
            new(0.098017140330, 0.995184726672),
            new(0.195090322016, 0.980785280403),
            new(0.290284677254, 0.956940335732),
            new(0.382683432365, 0.923879532511),
            new(0.471396736826, 0.881921264348),
            new(0.555570233020, 0.831469612303),
            new(0.634393284164, 0.773010453363),
            new(0.707106781187, 0.707106781187),
            new(0.773010453363, 0.634393284164),
            new(0.831469612303, 0.555570233020),
            new(0.881921264348, 0.471396736826),
            new(0.923879532511, 0.382683432365),
            new(0.956940335732, 0.290284677254),
            new(0.980785280403, 0.195090322016),
            new(0.995184726672, 0.098017140330),
        };
        private static readonly int[] stageRadix64 = new int[] { 4, 4, 4 };
        private static readonly int[] stageRemainder64 = new int[] { 16, 4, 1 };

        private static readonly Complex[] twiddles100 = new Complex[]
        {
            new(1.000000000000, -0.000000000000),
            new(0.998026728428, -0.062790519529),
            new(0.992114701314, -0.125333233564),
            new(0.982287250729, -0.187381314586),
            new(0.968583161129, -0.248689887165),
            new(0.951056516295, -0.309016994375),
            new(0.929776485888, -0.368124552685),
            new(0.904827052466, -0.425779291565),
            new(0.876306680044, -0.481753674102),
            new(0.844327925502, -0.535826794979),
            new(0.809016994375, -0.587785252292),
            new(0.770513242776, -0.637423989749),
            new(0.728968627421, -0.684547105929),
            new(0.684547105929, -0.728968627421),
            new(0.637423989749, -0.770513242776),
            new(0.587785252292, -0.809016994375),
            new(0.535826794979, -0.844327925502),
            new(0.481753674102, -0.876306680044),
            new(0.425779291565, -0.904827052466),
            new(0.368124552685, -0.929776485888),
            new(0.309016994375, -0.951056516295),
            new(0.248689887165, -0.968583161129),
            new(0.187381314586, -0.982287250729),
            new(0.125333233564, -0.992114701314),
            new(0.062790519529, -0.998026728428),
            new(-0.000000000000, -1.000000000000),
            new(-0.062790519529, -0.998026728428),
            new(-0.125333233564, -0.992114701314),
            new(-0.187381314586, -0.982287250729),
            new(-0.248689887165, -0.968583161129),
            new(-0.309016994375, -0.951056516295),
            new(-0.368124552685, -0.929776485888),
            new(-0.425779291565, -0.904827052466),
            new(-0.481753674102, -0.876306680044),
            new(-0.535826794979, -0.844327925502),
            new(-0.587785252292, -0.809016994375),
            new(-0.637423989749, -0.770513242776),
            new(-0.684547105929, -0.728968627421),
            new(-0.728968627421, -0.684547105929),
            new(-0.770513242776, -0.637423989749),
            new(-0.809016994375, -0.587785252292),
            new(-0.844327925502, -0.535826794979),
            new(-0.876306680044, -0.481753674102),
            new(-0.904827052466, -0.425779291565),
            new(-0.929776485888, -0.368124552685),
            new(-0.951056516295, -0.309016994375),
            new(-0.968583161129, -0.248689887165),
            new(-0.982287250729, -0.187381314586),
            new(-0.992114701314, -0.125333233564),
            new(-0.998026728428, -0.062790519529),
            new(-1.000000000000, 0.000000000000),
            new(-0.998026728428, 0.062790519529),
            new(-0.992114701314, 0.125333233564),
            new(-0.982287250729, 0.187381314586),
            new(-0.968583161129, 0.248689887165),
            new(-0.951056516295, 0.309016994375),
            new(-0.929776485888, 0.368124552685),
            new(-0.904827052466, 0.425779291565),
            new(-0.876306680044, 0.481753674102),
            new(-0.844327925502, 0.535826794979),
            new(-0.809016994375, 0.587785252292),
            new(-0.770513242776, 0.637423989749),
            new(-0.728968627421, 0.684547105929),
            new(-0.684547105929, 0.728968627421),
            new(-0.637423989749, 0.770513242776),
            new(-0.587785252292, 0.809016994375),
            new(-0.535826794979, 0.844327925502),
            new(-0.481753674102, 0.876306680044),
            new(-0.425779291565, 0.904827052466),
            new(-0.368124552685, 0.929776485888),
            new(-0.309016994375, 0.951056516295),
            new(-0.248689887165, 0.968583161129),
            new(-0.187381314586, 0.982287250729),
            new(-0.125333233564, 0.992114701314),
            new(-0.062790519529, 0.998026728428),
            new(-0.000000000000, 1.000000000000),
            new(0.062790519529, 0.998026728428),
            new(0.125333233564, 0.992114701314),
            new(0.187381314586, 0.982287250729),
            new(0.248689887165, 0.968583161129),
            new(0.309016994375, 0.951056516295),
            new(0.368124552685, 0.929776485888),
            new(0.425779291565, 0.904827052466),
            new(0.481753674102, 0.876306680044),
            new(0.535826794979, 0.844327925502),
            new(0.587785252292, 0.809016994375),
            new(0.637423989749, 0.770513242776),
            new(0.684547105929, 0.728968627421),
            new(0.728968627421, 0.684547105929),
            new(0.770513242776, 0.637423989749),
            new(0.809016994375, 0.587785252292),
            new(0.844327925502, 0.535826794979),
            new(0.876306680044, 0.481753674102),
            new(0.904827052466, 0.425779291565),
            new(0.929776485888, 0.368124552685),
            new(0.951056516295, 0.309016994375),
            new(0.968583161129, 0.248689887165),
            new(0.982287250729, 0.187381314586),
            new(0.992114701314, 0.125333233564),
            new(0.998026728428, 0.062790519529),
        };
        private static readonly int[] stageRadix100 = new int[] { 4, 5, 5 };
        private static readonly int[] stageRemainder100 = new int[] { 25, 5, 1 };

        private static readonly Dictionary<int, Case> cases = new Dictionary<int, Case>()
        {
            { 8, new Case(twiddles8, stageRadix8, stageRemainder8) },
            { 9, new Case(twiddles9, stageRadix9, stageRemainder9) },
            { 10, new Case(twiddles10, stageRadix10, stageRemainder10) },
            { 11, new Case(twiddles11, stageRadix11, stageRemainder11) },
            { 12, new Case(twiddles12, stageRadix12, stageRemainder12) },
            { 13, new Case(twiddles13, stageRadix13, stageRemainder13) },
            { 14, new Case(twiddles14, stageRadix14, stageRemainder14) },
            { 15, new Case(twiddles15, stageRadix15, stageRemainder15) },
            { 16, new Case(twiddles16, stageRadix16, stageRemainder16) },
            { 32, new Case(twiddles32, stageRadix32, stageRemainder32) },
            { 50, new Case(twiddles50, stageRadix50, stageRemainder50) },
            { 64, new Case(twiddles64, stageRadix64, stageRemainder64) },
            { 100, new Case(twiddles100, stageRadix100, stageRemainder100) },
        };

        private class Case
        {
            private readonly Complex[] twiddles;
            private readonly int[] stageRadix;
            private readonly int[] stageRemainder;

            public Case(Complex[] twiddles, int[] stageRadix, int[] stageRemainder)
            {
                this.twiddles = twiddles;
                this.stageRadix = stageRadix;
                this.stageRemainder = stageRemainder;
            }

            public ReadOnlySpan<Complex> Twiddles => twiddles;
            public ReadOnlySpan<int> StageRadix => stageRadix;
            public ReadOnlySpan<int> StageRemainder => stageRemainder;
        }
    }
}
